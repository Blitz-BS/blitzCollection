{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://raw.githubusercontent.com/Blitz-BS/blitzCollection/refs/heads/MGP-421-modularisation-de-l-objet-json-schema-pour-l-integ/json_schema/debt.schema.json",
    "title": "Créance",
    "description": "Créance dans un dossier",
    "oneOf" : [
        {
            "required": ["reference"],
            "additionalProperties": false,
            "type": "object",
            "properties": {
                "$schema": {
                    "title" : "Schéma JSON",
                    "description" : "URL du schéma",
                    "type": "string",
                    "format": "uri"
                },
                "reference" : {
                    "title" : "Référence",
                    "description" : "Référence de la créance chez le client de la société de recouvrement. Cette référence doit être unique pour un client donné. Ce schéma est utilisé quand la référence à une créance déjà connue en base suffit.",
                    "type": "string"
                }
            }
        },{
            "required": ["reference", "label", "debtCategory", "issueDate", "dueDate", "amount","vatAmount","balance", "balanceDate", "vatBalance"],
            "additionalProperties": false,
            "type": "object",
            "properties": {
                "$schema": {
                    "title" : "Schéma JSON",
                    "description" : "URL du schéma",
                    "type": "string",
                    "format": "uri"
                },
                "reference" : {
                    "title" : "Référence",
                    "description" : "Référence de la créance chez le client de la société de recouvrement. Cette référence doit être unique pour un client donné.",
                    "type": "string"
                },
                "label": {
                    "title": "Libellé",
                    "description": "Libellé de la pièce. Par exemple le numéro de la facture",
                    "type": "string",
                    "maxLength": 100
                },
                "debtCategory": {
                    "title": "Catégorie de créance",
                    "enum": ["invoice"]
                },
                "issueDate" : {
                    "title" : "Date de la pièce",
                    "description" : "Par exemple la date de la facture",
                    "type": "string",
                    "format" : "date"
                },
                "dueDate": {
                    "title": "Date d'échéance",
                    "description": "Date d'échéance de la créance",
                    "type": "string",
                    "format" : "date"
                },
                "amount": {
                    "title": "Montant de la pièce",
                    "description": "Montant de la créance en TTC à l'échéance",
                    "minimum": -999999999999.99,
                    "maximum": 999999999999.99
                },
                "vatAmount": {
                    "title" : "Montant de TVA",
                    "description" : "Montant de TVA de la créance à l'échéance",
                    "type": "number",
                    "minimum": -999999999999.99,
                    "maximum": 999999999999.99
                },   
                "balanceDate": {
                    "title": "Date de constatation du solde",
                    "description": "Date à laquelle le solde `balance` a été constaté",
                    "type": "string",
                    "format" : "date"
                },
                "balance": {
                    "title": "Solde",
                    "description": "Solde restant dû en TTC à la date `balanceDate`",
                    "minimum": -999999999999.99,
                    "maximum": 999999999999.99
                },
                "vatBalance": {
                    "title" : "Solde de la TVA",
                    "description" : "Solde de la TVA restant dû à la date `balanceDate`",
                    "type": "number",
                    "minimum": -999999999999.99,
                    "maximum": 999999999999.99
                },                                 
                "currencyCode": {
                    "$ref" : "./currencyCode.schema.json"
                },
                "incidentals": {
                    "title" : "Frais accessoires",
                    "description" : "Frais accessoires attachés à la créance",
                    "type": "array",
                    "items": {
                        "$ref": "./incidental.schema.json"
                    }
                }
            }
        }
    ]
}
